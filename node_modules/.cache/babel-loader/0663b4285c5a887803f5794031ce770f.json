{"ast":null,"code":"import _objectSpread from\"/Users/yonekawatakashinari/Desktop/js-practice/yone-ec-site/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{createSlice}from\"@reduxjs/toolkit\";//stateの型を記述する\nvar arr=localStorage.getItem('cartItems');var initialState={cartItems:[],cartShow:[],totalPrice:0,totalAmount:0};var cartSlice=createSlice({name:\"cart\",initialState:initialState,reducers:{addCart:function addCart(state,action){var current=[_objectSpread({},state.cartItems)];if(arr!==null){current=JSON.parse(arr);}current.push(action.payload);var cartArray=JSON.stringify(current);localStorage.setItem('cartItems',cartArray);arr=localStorage.getItem('cartItems');state.cartItems=arr;window.location.href='/';//  window.location.reload();\nalert('カートへ追加が完了しました。');},removeAll:function removeAll(state){state.cartItems=[];localStorage.setItem('cartItems',JSON.stringify(state.cartItems));// window.location.reload();\n},removeItem:function removeItem(state,action){var itemId=action.payload;state.cartShow=state.cartShow.filter(function(item){return item.id!==itemId;});localStorage.setItem('cartItems',JSON.stringify(state.cartShow));// window.location.reload();\n},handleCart:function handleCart(state){arr=localStorage.getItem('cartItems');if(arr!==null){state.cartItems=JSON.parse(arr);// 重複表示回避\nvar map=new Map(state.cartItems.map(function(o){return[o.id,o];}));state.cartShow=Array.from(map.values());}},handleTotalAmount:function handleTotalAmount(state){var current=[_objectSpread({},state.cartItems)];if(arr!==null){current=JSON.parse(arr);}state.totalAmount=current.length;},handleTotalPrice:function handleTotalPrice(state){var total=0;state.cartItems.forEach(function(item){total+=item.price;});//新しい状態に更新\nstate.totalPrice=total;}}});var _cartSlice$actions=cartSlice.actions,addCart=_cartSlice$actions.addCart,removeAll=_cartSlice$actions.removeAll,removeItem=_cartSlice$actions.removeItem,handleCart=_cartSlice$actions.handleCart,handleTotalAmount=_cartSlice$actions.handleTotalAmount,handleTotalPrice=_cartSlice$actions.handleTotalPrice;export{addCart,removeAll,removeItem,handleCart,handleTotalAmount,handleTotalPrice};export default cartSlice.reducer;","map":{"version":3,"names":["createSlice","arr","localStorage","getItem","initialState","cartItems","cartShow","totalPrice","totalAmount","cartSlice","name","reducers","addCart","state","action","current","JSON","parse","push","payload","cartArray","stringify","setItem","window","location","href","alert","removeAll","removeItem","itemId","filter","item","id","handleCart","map","Map","o","Array","from","values","handleTotalAmount","length","handleTotalPrice","total","forEach","price","actions","reducer"],"sources":["/Users/yonekawatakashinari/Desktop/js-practice/yone-ec-site/src/redux/cart/cartSlice.tsx"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\n\n//stateの型を記述する\nexport interface apiState {\n  cartItems: {\n    id: number | string;\n    title: string;\n    price: number;\n    image: string;\n  }[];\n  cartShow: {\n    id: number | string;\n    title: string;\n    price: number;\n    image: string;\n  }[];\n  totalPrice: number\n  totalAmount: number;\n}\n\nlet arr:any= localStorage.getItem('cartItems') ;\n\n\nconst initialState:apiState  = {\n  cartItems: [],\n  cartShow: [],\n  totalPrice: 0,\n  totalAmount: 0,\n};\n\nconst cartSlice = createSlice({\n  name: \"cart\",\n  initialState,\n  reducers: {\n    addCart:  (state, action) => {\n\n      let current = [{...state.cartItems}]\n      if(arr !== null){\n        current= JSON.parse(arr);       \n      }\n      current.push(action.payload);\n      let cartArray = JSON.stringify(current);\n      localStorage.setItem('cartItems', cartArray);\n      arr = localStorage.getItem('cartItems');\n      state.cartItems = arr;\n      window.location.href = '/';\n      //  window.location.reload();\n      alert('カートへ追加が完了しました。')\n\n    },\n    removeAll: (state) => {\n      state.cartItems = [];\n      localStorage.setItem('cartItems', JSON.stringify(state.cartItems));\n      // window.location.reload();\n\n    },\n    removeItem:(state, action) => {\n      const itemId = action.payload;\n      state.cartShow = state.cartShow.filter((item) => item.id !== itemId);\n      localStorage.setItem('cartItems', JSON.stringify(state.cartShow));\n      // window.location.reload();\n\n    },\n    handleCart:(state) => {\n      arr = localStorage.getItem('cartItems');\n      if(arr !== null){\n        state.cartItems = JSON.parse(arr);\n\n        // 重複表示回避\n        let map = new Map(state.cartItems.map((o) => [o.id, o]));\n        state.cartShow = Array.from(map.values())\n      }\n      \n    },\n    handleTotalAmount: (state) => {\n      let current = [{...state.cartItems}]\n      if(arr !== null){current= JSON.parse(arr);}\n        state.totalAmount = current.length;\n    },\n    handleTotalPrice: (state) => {\n      let total:number = 0;\n      state.cartItems.forEach((item) => {\n        total += item.price;\n      });\n      //新しい状態に更新\n      state.totalPrice = total;\n    }\n  },\n});\n\nexport const { addCart, removeAll ,removeItem, handleCart,handleTotalAmount,handleTotalPrice } = cartSlice.actions;\nexport default cartSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}